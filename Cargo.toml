[workspace]
members = [
    "frame-analyzer",
    "frame-analyzer-ebpf",
    "frame-analyzer-ebpf-common",
    "examples/simple-analyzer",
    "xtask"
]
resolver = "2"
default-members = ["frame-analyzer-ebpf-common", "frame-analyzer-ebpf"]

[workspace.package]
edition = "2024"
version = "0.3.4"
authors = ["shadow3aaa@github.com"]
license = "GPL-3.0"
repository = "https://github.com/shadow3aaa/frame-analyzer-ebpf"
description = "eBPF-based frame analyzer for Android"
documentation = "https://docs.rs/frame-analyzer-ebpf"
readme = "README.md"
keywords = ["ebpf", "android", "frame-analysis"]
categories = ["os::linux-programming", "embedded"]
homepage = "https://github.com/shadow3aaa/frame-analyzer-ebpf"

[workspace.dependencies]
# 项目内部依赖
frame-analyzer = { path = "./frame-analyzer", version = "0.3.4" }
frame-analyzer-ebpf-common = { path = "./frame-analyzer-ebpf-common", version = "0.3.4" }
# eBPF框架依赖
aya = "0.13.1"
aya-ebpf = "0.1.1"
cty = "0.2.2"
# 系统/跨平台依赖：删除libc的android特性（该特性不存在）
libc = { version = "0.2.153", features = [] }
mio = { version = "1.0.4", features = ["os-ext"] }
cc = "1.0"
# 通用工具依赖
anyhow = "1.0.75"
serde = { version = "1.0.193", features = ["derive"] }
serde_json = "1.0.108"
# 示例程序、核心库与xtask的第三方依赖
clap = { version = "4.5.4", features = ["derive"] }
ctrlc = "3.4.4"
thiserror = "1.0.57"
ctor = "0.4.0"
once_cell = "1.19.0"
# xtask编译依赖
cargo_metadata = "0.15.4"

# 工作区全局profile配置
[profile.release]
lto = true
codegen-units = 1
panic = "abort"
debug = false
opt-level = "s"
debug-assertions = false
strip = "symbols"

[profile.dev]
opt-level = 3
debug = false
debug-assertions = false
overflow-checks = false
lto = true
panic = "abort"
incremental = false
codegen-units = 1
rpath = false
